package dao

import (
	"cve-sa-backend/iniconf"
	"cve-sa-backend/models"
	"cve-sa-backend/utils"
)

func ByPackageName(pnames []string) (datas []models.CveSecurityNoticePackage, err error) {
	if err = iniconf.DB.
		Model(&models.CveSecurityNoticePackage{}).
		Where("package_name in ?", pnames).
		Find(&datas).Error; err != nil {
		if utils.ErrorNotFound(err) {
			err = nil
			return
		}
		return nil, err
	}
	return
}

func NoticePackageByNoProduct(securityNoticeNo, product string) (datas []models.CveSecurityNoticePackage, err error) {
	if err = iniconf.DB.
		Model(&models.CveSecurityNoticePackage{}).
		Where("security_notice_no = ?", securityNoticeNo).
		Where("product_name = ?", product).
		Find(&datas).Error; err != nil {
		if utils.ErrorNotFound(err) {
			err = nil
			return
		}
		return nil, err
	}
	return
}
