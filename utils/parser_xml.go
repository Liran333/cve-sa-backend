package utils

import (
	"encoding/xml"
)

type (
	UnaffectCveXml struct {
		Cvrfdoc       xml.Name       `parsexml:"cvrfdoc"`
		Xmlns         string         `parsexml:"xmlns,attr"`
		Vulnerability []UnaffectBody `parsexml:"Vulnerability"`
	}

	FixedCveXml struct {
		DocumentTitle      string                 `parsexml:"DocumentTitle"`
		DocumentType       string                 `parsexml:"DocumentType"`
		DocumentPublisher  DocumentPublisherChild `parsexml:"DocumentPublisher"`
		DocumentTracking   DocumentTracking       `parsexml:"DocumentTracking"`
		DocumentNotes      DocumentNotesChild     `parsexml:"DocumentNotes"`
		DocumentReferences Reference              `parsexml:"DocumentReferences"`
		ProductTree        Branch                 `parsexml:"ProductTree"`
		Vulnerability      []UnaffectBody         `parsexml:"Vulnerability"`
	}

	//Vulnerability struct {
	//	Vulnerability []UnaffectBody `yaml:"Vulnerability"`
	//}

	UnaffectBody struct {
		Ordinal         string      `parsexml:"Ordinal,attr"`
		Xmlns           string      `parsexml:"xmlns,attr"`
		Notes           Note        `parsexml:"Notes"`
		ReleaseDate     string      `parsexml:"ReleaseDate"`
		Cve             string      `parsexml:"CVE"`
		ProductStatuses Status      `parsexml:"ProductStatuses"`
		Threats         Threat      `parsexml:"Threats"`
		CVSSScoreSets   ScoreSet    `parsexml:"CVSSScoreSets"`
		Remediations    Remediation `parsexml:"Remediations"`
	}

	Note struct {
		Note []Notes
	}

	Status struct {
		Status []ProductID `parsexml:"Status"`
	}

	ProductID struct {
		Type      string   `parsexml:"Type,attr"`
		ProductID []string `parsexml:"ProductID"`
	}

	ScoreSet struct {
		ScoreSet ScoreSetChild `parsexml:"ScoreSet"`
	}

	ScoreSetChild struct {
		BaseScore string `parsexml:"BaseScore"`
		Vector    string `parsexml:"Vector"`
	}

	Remediation struct {
		Remediation []RemediationChild `parsexml:"Remediation"`
	}

	RemediationChild struct {
		Type        string `parsexml:"Type,attr"`
		Description string `parsexml:"Description"`
		DATE        string `parsexml:"DATE"`
		ProductID   string `parsexml:"ProductID"`
		URL         string `parsexml:"URL"`
	}

	DocumentPublisherChild struct {
		Type             string `parsexml:"Type,attr"`
		ContactDetails   string `parsexml:"ContactDetails"`
		IssuingAuthority string `parsexml:"IssuingAuthority"`
	}

	DocumentTracking struct {
		Identification     IdentificationChild `parsexml:"Identification"`
		Status             string              `parsexml:"Status"`
		Version            string              `parsexml:"Version"`
		RevisionHistory    Revision            `parsexml:"RevisionHistory"`
		InitialReleaseDate string              `parsexml:"InitialReleaseDate"`
		CurrentReleaseDate string              `parsexml:"CurrentReleaseDate"`
		Generator          GeneratorChild      `parsexml:"Generator"`
	}

	Revision struct {
		Revision []RevisionChild `parsexml:"Revision"`
	}

	RevisionChild struct {
		Number      string `parsexml:"Number"`
		Date        string `parsexml:"Date"`
		Description string `parsexml:"Description"`
	}

	GeneratorChild struct {
		Engine string `parsexml:"Engine"`
		Date   string `parsexml:"Date"`
	}

	IdentificationChild struct {
		ID string `parsexml:"ID"`
	}

	DocumentNotesChild struct {
		//Notes []Notes `parsexml:"Note"`
		//Note []Notes
		Note []Notes
		//Notes Notes
	}
	Notes struct {
		Title   string `parsexml:"Title,attr"`
		Type    string `parsexml:"Type,attr"`
		Ordinal string `parsexml:"Ordinal,attr"`
		Note    string `parsexml:",innerxml"`
	}

	Reference struct {
		Reference []ReferenceChild `parsexml:"Reference"`
	}

	ReferenceChild struct {
		Type string `parsexml:"Type,attr"`
		URL  string `parsexml:"URL"`
	}

	Branch struct {
		Branch []BranchChild `parsexml:"Branch"`
	}

	BranchChild struct {
		Type            string                 `parsexml:"Type,attr"`
		Name            string                 `parsexml:"Name,attr"`
		FullProductName []FullProductNameChild `parsexml:"FullProductName"`
	}
	FullProductNameChild struct {
		ProductID   string `parsexml:"ProductID,attr"`
		CPE         string `parsexml:"CPE,attr"`
		ProductName string `parsexml:",innerxml"`
	}

	Threat struct {
		Threat ThreatChild `parsexml:"Threat"`
	}

	ThreatChild struct {
		Type        string `parsexml:"Type,attr"`
		Description string `parsexml:"Description"`
	}
)
