package utils

import (
	"encoding/xml"
)

type (
	UnaffectCveXml struct {
		Cvrfdoc       xml.Name       `xml:"cvrfdoc"`
		Xmlns         string         `xml:"xmlns,attr"`
		Vulnerability []UnaffectBody `xml:"Vulnerability"`
	}

	FixedCveXml struct {
		DocumentTitle      string                 `xml:"DocumentTitle"`
		DocumentType       string                 `xml:"DocumentType"`
		DocumentPublisher  DocumentPublisherChild `xml:"DocumentPublisher"`
		DocumentTracking   DocumentTracking       `xml:"DocumentTracking"`
		DocumentNotes      DocumentNotesChild     `xml:"DocumentNotes"`
		DocumentReferences Reference              `xml:"DocumentReferences"`
		ProductTree        Branch                 `xml:"ProductTree"`
		Vulnerability      []UnaffectBody         `xml:"Vulnerability"`
	}

	//Vulnerability struct {
	//	Vulnerability []UnaffectBody `yaml:"Vulnerability"`
	//}

	UnaffectBody struct {
		Ordinal         string      `xml:"Ordinal,attr"`
		Xmlns           string      `xml:"xmlns,attr"`
		Notes           Note        `xml:"Notes"`
		ReleaseDate     string      `xml:"ReleaseDate"`
		Cve             string      `xml:"CVE"`
		ProductStatuses Status      `xml:"ProductStatuses"`
		Threats         Threat      `xml:"Threats"`
		CVSSScoreSets   ScoreSet    `xml:"CVSSScoreSets"`
		Remediations    Remediation `xml:"Remediations"`
	}

	Note struct {
		Note []Notes
	}

	Status struct {
		Status []ProductID `xml:"Status"`
	}

	ProductID struct {
		Type      string   `xml:"Type,attr"`
		ProductID []string `xml:"ProductID"`
	}

	ScoreSet struct {
		ScoreSet ScoreSetChild `xml:"ScoreSet"`
	}

	ScoreSetChild struct {
		BaseScore string `xml:"BaseScore"`
		Vector    string `xml:"Vector"`
	}

	Remediation struct {
		Remediation []RemediationChild `xml:"Remediation"`
	}

	RemediationChild struct {
		Type        string `xml:"Type,attr"`
		Description string `xml:"Description"`
		DATE        string `xml:"DATE"`
		ProductID   string `xml:"ProductID"`
		URL         string `xml:"URL"`
	}

	DocumentPublisherChild struct {
		Type             string `xml:"Type,attr"`
		ContactDetails   string `xml:"ContactDetails"`
		IssuingAuthority string `xml:"IssuingAuthority"`
	}

	DocumentTracking struct {
		Identification     IdentificationChild `xml:"Identification"`
		Status             string              `xml:"Status"`
		Version            string              `xml:"Version"`
		RevisionHistory    Revision            `xml:"RevisionHistory"`
		InitialReleaseDate string              `xml:"InitialReleaseDate"`
		CurrentReleaseDate string              `xml:"CurrentReleaseDate"`
		Generator          GeneratorChild      `xml:"Generator"`
	}

	Revision struct {
		Revision []RevisionChild `xml:"Revision"`
	}

	RevisionChild struct {
		Number      string `xml:"Number"`
		Date        string `xml:"Date"`
		Description string `xml:"Description"`
	}

	GeneratorChild struct {
		Engine string `xml:"Engine"`
		Date   string `xml:"Date"`
	}

	IdentificationChild struct {
		ID string `xml:"ID"`
	}

	DocumentNotesChild struct {
		//Notes []Notes `xml:"Note"`
		//Note []Notes
		Note []Notes
		//Notes Notes
	}
	Notes struct {
		Title   string `xml:"Title,attr"`
		Type    string `xml:"Type,attr"`
		Ordinal string `xml:"Ordinal,attr"`
		Note    string `xml:",innerxml"`
	}

	Reference struct {
		Reference []ReferenceChild `xml:"Reference"`
	}

	ReferenceChild struct {
		Type string `xml:"Type,attr"`
		URL  string `xml:"URL"`
	}

	Branch struct {
		Branch []BranchChild `xml:"Branch"`
	}

	BranchChild struct {
		Type            string                 `xml:"Type,attr"`
		Name            string                 `xml:"Name,attr"`
		FullProductName []FullProductNameChild `xml:"FullProductName"`
	}
	FullProductNameChild struct {
		ProductID   string `xml:"ProductID,attr"`
		CPE         string `xml:"CPE,attr"`
		ProductName string `xml:",innerxml"`
	}

	Threat struct {
		Threat ThreatChild `xml:"Threat"`
	}

	ThreatChild struct {
		Type        string `xml:"Type,attr"`
		Description string `xml:"Description"`
	}
)
